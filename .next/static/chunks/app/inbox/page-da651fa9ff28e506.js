(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[329],{976:(e,a,s)=>{Promise.resolve().then(s.bind(s,4111))},4111:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>i});var t=s(5155),n=s(2115),l=s(8754);function i(){let[e,a]=(0,n.useState)([]),[s,i]=(0,n.useState)(1),[r,c]=(0,n.useState)(0),[d,o]=(0,n.useState)(!1),h=(0,n.useRef)(null),[u,p]=(0,n.useState)("all"),[x,m]=(0,n.useState)("all"),[j,v]=(0,n.useState)(""),y=(0,n.useMemo)(()=>Math.max(1,Math.ceil(r/20)),[r]),b=async e=>{o(!0);try{let s=new URLSearchParams({status:u,read:x,search:j,pageNumber:String(e),pageSize:String(20)}),t=await fetch("http://localhost:5000/api/Message/messages?".concat(s.toString()));if(!t.ok)return;let n=await t.json(),l=((null==n?void 0:n.data)||[]).map(e=>({id:e.id,threadId:e.threadId,content:e.content,createdAt:e.createdAt,isApprove:!0===e.isApprove,reason:"",senderId:e.senderId,receiverId:e.receiverId,isRead:e.isRead}));c(Number((null==n?void 0:n.totalCount)||l.length)),a(l)}finally{o(!1)}};(0,n.useEffect)(()=>{b(s)},[s,u,x,j]),(0,n.useEffect)(()=>{let e=new EventSource("http://localhost:5000/api/Dialog/stream");return h.current=e,e.onmessage=()=>{b(s)},e.onerror=()=>{},()=>{e.close(),h.current=null}},[s]);let N=async(e,a)=>{await fetch("http://localhost:5000/api/Dialog/".concat(e,"/approve"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})};return(0,t.jsx)(l.A,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:18,fontWeight:700},children:"Inbox"}),(0,t.jsx)("div",{style:{color:"#6b7280"},children:"Onay bekleyen mesajlar"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,t.jsx)("input",{placeholder:"Ara...",value:j,onChange:e=>v(e.target.value),className:"btn",style:{padding:"8px 12px"}}),(0,t.jsxs)("select",{className:"btn",value:u,onChange:e=>p(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"Durum: Hepsi"}),(0,t.jsx)("option",{value:"pending",children:"Bekleyen"}),(0,t.jsx)("option",{value:"approved",children:"Onaylı"}),(0,t.jsx)("option",{value:"rejected",children:"Reddedilen"})]}),(0,t.jsxs)("select",{className:"btn",value:x,onChange:e=>m(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"Okuma: Hepsi"}),(0,t.jsx)("option",{value:"unread",children:"Okunmayan"}),(0,t.jsx)("option",{value:"read",children:"Okunan"})]})]})]}),d?(0,t.jsx)("div",{className:"empty",children:"Y\xfckleniyor..."}):0===e.length?(0,t.jsx)("div",{className:"empty",children:"G\xf6sterilecek mesaj yok"}):(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Mesaj"}),(0,t.jsx)("th",{children:"Oluşturulma"}),(0,t.jsx)("th",{children:"İşlem"})]})}),(0,t.jsx)("tbody",{children:e.map(e=>(0,t.jsxs)("tr",{style:{opacity:e.isRead?1:.6},children:[(0,t.jsx)("td",{title:e.content,style:{maxWidth:900,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.content}),(0,t.jsx)("td",{style:{width:220},children:new Date(e.createdAt).toLocaleString("tr-TR")}),(0,t.jsx)("td",{style:{width:220},children:(0,t.jsxs)("div",{className:"actions",children:[(0,t.jsx)("button",{className:"btn",onClick:()=>N(e.id,!1),children:"Reddet"}),(0,t.jsx)("button",{className:"btn btn-primary",onClick:()=>N(e.id,!0),children:"Onayla"})]})})]},e.id))})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,marginTop:16,alignItems:"center"},children:[(0,t.jsx)("button",{className:"btn",disabled:s<=1,onClick:()=>i(e=>Math.max(1,e-1)),children:"\xd6nceki"}),(0,t.jsxs)("div",{children:["Sayfa ",s," / ",y]}),(0,t.jsx)("button",{className:"btn",disabled:s>=y,onClick:()=>i(e=>Math.min(y,e+1)),children:"Sonraki"})]})]})})}},8754:(e,a,s)=>{"use strict";s.d(a,{A:()=>r});var t=s(5155),n=s(6874),l=s.n(n),i=s(8999);function r(e){let{children:a}=e,s=(0,i.usePathname)();return(0,t.jsxs)("div",{className:"panel-root",children:[(0,t.jsxs)("aside",{className:"panel-aside",children:[(0,t.jsxs)("div",{className:"brand",children:["Stand Pazarı",(0,t.jsx)("br",{}),"Control Panel"]}),(0,t.jsxs)("nav",{className:"nav",children:[(0,t.jsx)(l(),{className:"nav-item ".concat("/inbox"===s?"active":""),href:"/inbox",children:"\uD83D\uDCE5 Inbox"}),(0,t.jsx)(l(),{className:"nav-item ".concat("/groups"===s?"active":""),href:"/groups",children:"\uD83D\uDC65 Gruplar"}),(0,t.jsx)(l(),{className:"nav-item ".concat("/customers"===s?"active":""),href:"/customers",children:"\uD83E\uDDD1‍\uD83D\uDCBC Customers"}),(0,t.jsx)(l(),{className:"nav-item ".concat("/suppliers"===s?"active":""),href:"/suppliers",children:"\uD83C\uDFED Suppliers"})]}),(0,t.jsx)("div",{className:"aside-foot",children:"v0.1.0"})]}),(0,t.jsxs)("main",{className:"panel-main",children:[(0,t.jsxs)("header",{className:"panel-header",children:[(0,t.jsx)("div",{className:"hdr-title",children:"Mesaj Moderasyonu"}),(0,t.jsx)("div",{className:"hdr-actions",children:(0,t.jsx)("span",{className:"badge live",children:"● Canlı"})})]}),(0,t.jsx)("section",{className:"panel-content",children:a})]})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[874,441,684,358],()=>a(976)),_N_E=e.O()}]);