{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/projects/StandPazari/standpazaricontrolpanel/src/components/PanelLayout.tsx"],"sourcesContent":["'use client'\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\n\nexport default function PanelLayout({ children }: { children: React.ReactNode }) {\n  const pathname = usePathname()\n  const isActive = (href: string) => pathname === href\n  return (\n    <div className=\"panel-root\">\n      <aside className=\"panel-aside\">\n        <div className=\"brand\">Stand Pazarƒ±<br/>Control Panel</div>\n        <nav className=\"nav\">\n          <Link className={`nav-item ${isActive('/inbox') ? 'active' : ''}`} href=\"/inbox\">üì• Inbox</Link>\n          <Link className={`nav-item ${isActive('/groups') ? 'active' : ''}`} href=\"/groups\">üë• Gruplar</Link>\n          <Link className={`nav-item ${isActive('/customers') ? 'active' : ''}`} href=\"/customers\">üßë‚Äçüíº Customers</Link>\n          <Link className={`nav-item ${isActive('/suppliers') ? 'active' : ''}`} href=\"/suppliers\">üè≠ Suppliers</Link>\n        </nav>\n        <div className=\"aside-foot\">v0.1.0</div>\n      </aside>\n      <main className=\"panel-main\">\n        <header className=\"panel-header\">\n          <div className=\"hdr-title\">Mesaj Moderasyonu</div>\n          <div className=\"hdr-actions\">\n            <span className=\"badge live\">‚óè Canlƒ±</span>\n          </div>\n        </header>\n        <section className=\"panel-content\">{children}</section>\n      </main>\n    </div>\n  )\n}\n\n\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;;AAIe,SAAS,YAAY,EAAE,QAAQ,EAAiC;IAC7E,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAC3B,MAAM,WAAW,CAAC,OAAiB,aAAa;IAChD,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAM,WAAU;;kCACf,8OAAC;wBAAI,WAAU;;4BAAQ;0CAAY,8OAAC;;;;;4BAAI;;;;;;;kCACxC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,4JAAA,CAAA,UAAI;gCAAC,WAAW,CAAC,SAAS,EAAE,SAAS,YAAY,WAAW,IAAI;gCAAE,MAAK;0CAAS;;;;;;0CACjF,8OAAC,4JAAA,CAAA,UAAI;gCAAC,WAAW,CAAC,SAAS,EAAE,SAAS,aAAa,WAAW,IAAI;gCAAE,MAAK;0CAAU;;;;;;0CACnF,8OAAC,4JAAA,CAAA,UAAI;gCAAC,WAAW,CAAC,SAAS,EAAE,SAAS,gBAAgB,WAAW,IAAI;gCAAE,MAAK;0CAAa;;;;;;0CACzF,8OAAC,4JAAA,CAAA,UAAI;gCAAC,WAAW,CAAC,SAAS,EAAE,SAAS,gBAAgB,WAAW,IAAI;gCAAE,MAAK;0CAAa;;;;;;;;;;;;kCAE3F,8OAAC;wBAAI,WAAU;kCAAa;;;;;;;;;;;;0BAE9B,8OAAC;gBAAK,WAAU;;kCACd,8OAAC;wBAAO,WAAU;;0CAChB,8OAAC;gCAAI,WAAU;0CAAY;;;;;;0CAC3B,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCAAK,WAAU;8CAAa;;;;;;;;;;;;;;;;;kCAGjC,8OAAC;wBAAQ,WAAU;kCAAiB;;;;;;;;;;;;;;;;;;AAI5C","debugId":null}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file://C%3A/projects/StandPazari/standpazaricontrolpanel/src/app/inbox/page.tsx"],"sourcesContent":["'use client'\nimport { useEffect, useMemo, useRef, useState } from 'react'\nimport PanelLayout from '../../components/PanelLayout'\n\ntype PendingDialog = {\n  id: string\n  threadId: string\n  content: string\n  createdAt: string\n  isApprove: boolean\n  reason: string\n  senderId: string\n  receiverId: string\n  isRead?: boolean\n}\n\nexport default function Inbox() {\n  const [items, setItems] = useState<PendingDialog[]>([])\n  const [page, setPage] = useState(1)\n  const [total, setTotal] = useState(0)\n  const [loading, setLoading] = useState(false)\n  const esRef = useRef<EventSource | null>(null)\n  const [status, setStatus] = useState<'all'|'pending'|'approved'|'rejected'>('all')\n  const [read, setRead] = useState<'all'|'read'|'unread'>('all')\n  const [search, setSearch] = useState('')\n\n  const pageSize = 20\n  const totalPages = useMemo(() => Math.max(1, Math.ceil(total / pageSize)), [total])\n\n  const fetchPage = async (p: number) => {\n    setLoading(true)\n    try {\n      const qs = new URLSearchParams({ status, read, search, pageNumber: String(p), pageSize: String(pageSize) })\n      const r = await fetch(`http://localhost:5000/api/Message/messages?${qs.toString()}`)\n      if (!r.ok) return\n      const json = await r.json()\n      const all: PendingDialog[] = (json?.data || []).map((d: any) => ({\n        id: d.id,\n        threadId: d.threadId,\n        content: d.content,\n        createdAt: d.createdAt,\n        isApprove: d.isApprove === true,\n        reason: d.reason || '',\n        senderId: d.senderId,\n        receiverId: d.receiverId,\n        isRead: d.isRead,\n      }))\n      setTotal(Number(json?.totalCount || all.length))\n      setItems(all)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => { fetchPage(page) }, [page, status, read, search])\n\n  // SSE aboneliƒüi: onay deƒüi≈üince listeyi tazele\n  useEffect(() => {\n    const es = new EventSource('http://localhost:5000/api/Dialog/stream')\n    esRef.current = es\n    es.onmessage = () => { fetchPage(page) }\n    es.onerror = () => {}\n    return () => { es.close(); esRef.current = null }\n  }, [page])\n\n  const updateStatus = async (messageId: string, isApprove: boolean) => {\n    if (isApprove) {\n      const ok = confirm('Bu mesajƒ± onaylamak istiyor musunuz?')\n      if (!ok) return\n      // Hem durum g√ºncelle hem SSE yayƒ±nƒ±nƒ± tetikle\n      await fetch(`http://localhost:5000/api/Dialog/${messageId}/approve`, { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(true) })\n      alert('Mesaj onaylandƒ±')\n      return\n    }\n    const reason = prompt('Reddetme sebebi:') || ''\n    // Yeni REST endpoint: reason ile birlikte yaz\n    await fetch(`http://localhost:5000/api/Message/message/${messageId}/moderate`, {\n      method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ isApprove: false, reason })\n    })\n    // SSE yayƒ±nƒ±nƒ± tetikle (control-panel-service √ºzerinden)\n    await fetch(`http://localhost:5000/api/Dialog/${messageId}/approve`, {\n      method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(false)\n    })\n    alert('Mesaj reddedildi')\n  }\n\n  return (\n    <PanelLayout>\n      <div>\n        <div style={{display:'flex',justifyContent:'space-between',marginBottom:16}}>\n          <div>\n            <div style={{fontSize:18,fontWeight:700}}>Inbox</div>\n            <div style={{color:'#6b7280'}}>Onay bekleyen mesajlar</div>\n          </div>\n          <div style={{display:'flex',gap:8}}>\n            <input placeholder=\"Ara...\" value={search} onChange={e=>setSearch(e.target.value)} className=\"btn\" style={{padding:'8px 12px'}} />\n            <select className=\"btn\" value={status} onChange={e=>setStatus(e.target.value as any)}>\n              <option value=\"all\">Durum: Hepsi</option>\n              <option value=\"pending\">Bekleyen</option>\n              <option value=\"approved\">Onaylƒ±</option>\n              <option value=\"rejected\">Reddedilen</option>\n            </select>\n            <select className=\"btn\" value={read} onChange={e=>setRead(e.target.value as any)}>\n              <option value=\"all\">Okuma: Hepsi</option>\n              <option value=\"unread\">Okunmayan</option>\n              <option value=\"read\">Okunan</option>\n            </select>\n          </div>\n        </div>\n        {loading ? <div className=\"empty\">Y√ºkleniyor...</div> : (\n          items.length === 0 ? (\n            <div className=\"empty\">G√∂sterilecek mesaj yok</div>\n          ) : (\n            <table className=\"table\">\n            <thead>\n              <tr>\n                <th>Mesaj</th>\n                <th>G√∂nderen</th>\n                <th>Alƒ±cƒ±</th>\n                <th>Proje</th>\n                <th>Durum</th>\n                <th>Olu≈üturulma</th>\n                <th>ƒ∞≈ülem</th>\n              </tr>\n            </thead>\n              <tbody>\n                {items.map(i => {\n                  const status = i.isApprove ? 'Onaylƒ±' : (i.reason ? 'Reddedildi' : 'Bekliyor')\n                  return (\n                  <tr key={i.id} style={{opacity: i.isRead ? 1 : .7}}>\n                    <td title={i.content} style={{maxWidth:440,overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'}}>{i.content}</td>\n                    <td style={{width:160,fontFamily:'ui-monospace'}}>{(i.senderId||'').slice(0,8)}...</td>\n                    <td style={{width:160,fontFamily:'ui-monospace'}}>{(i.receiverId||'').slice(0,8)}...</td>\n                    <td style={{width:160,fontFamily:'ui-monospace'}}>{(i.threadId||'').slice(0,8)}...</td>\n                    <td style={{width:160}}>\n                      {status === 'Onaylƒ±' && <span className=\"badge\" style={{background:'#ecfdf5',borderColor:'#a7f3d0',color:'#166534'}}>Onaylƒ±</span>}\n                      {status === 'Reddedildi' && <span className=\"badge\" style={{background:'#fef2f2',borderColor:'#fecaca',color:'#991b1b'}}>Reddedildi</span>}\n                      {status === 'Bekliyor' && <span className=\"badge\" style={{background:'#fff7ed',borderColor:'#fed7aa',color:'#9a3412'}}>Bekliyor</span>}\n                      {i.reason && (\n                        <div style={{marginTop:6,color:'#6b7280',fontSize:12}}>Sebep: {i.reason}</div>\n                      )}\n                    </td>\n                    <td style={{width:160}}>{new Date(i.createdAt).toLocaleString('tr-TR')}</td>\n                    <td style={{width:200}}>\n                      <div className=\"actions\">\n                        <button className=\"btn\" onClick={() => updateStatus(i.id, false)}>Reddet</button>\n                        <button className=\"btn btn-primary\" onClick={() => updateStatus(i.id, true)}>Onayla</button>\n                      </div>\n                    </td>\n                  </tr>\n                )})}\n              </tbody>\n            </table>\n          )\n        )}\n        <div style={{display:'flex',gap:8,marginTop:16,alignItems:'center'}}>\n          <button className=\"btn\" disabled={page<=1} onClick={()=>setPage(p=>Math.max(1,p-1))}>√ñnceki</button>\n          <div>Sayfa {page} / {totalPages}</div>\n          <button className=\"btn\" disabled={page>=totalPages} onClick={()=>setPage(p=>Math.min(totalPages,p+1))}>Sonraki</button>\n        </div>\n      </div>\n    </PanelLayout>\n  )\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}